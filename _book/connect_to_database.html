<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Oxinfer onboarding - 1&nbsp; Connect to the database</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Connect to the database</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Oxinfer onboarding</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./connect_to_database.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Connect to the database</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link active" data-scroll-target="#getting-started"><span class="toc-section-number">1.1</span>  Getting started</a></li>
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries"><span class="toc-section-number">1.2</span>  Load libraries</a></li>
  <li><a href="#set-connection-details" id="toc-set-connection-details" class="nav-link" data-scroll-target="#set-connection-details"><span class="toc-section-number">1.3</span>  Set connection details</a></li>
  <li><a href="#substitute-the-next-5-lines-with-the-specifications-of-the-database-that-you" id="toc-substitute-the-next-5-lines-with-the-specifications-of-the-database-that-you" class="nav-link" data-scroll-target="#substitute-the-next-5-lines-with-the-specifications-of-the-database-that-you"><span class="toc-section-number">1.4</span>  Substitute the next 5 lines with the specifications of the database that you</a></li>
  <li><a href="#want-to-connect" id="toc-want-to-connect" class="nav-link" data-scroll-target="#want-to-connect"><span class="toc-section-number">1.5</span>  want to connect</a></li>
  <li><a href="#connect-to-the-database" id="toc-connect-to-the-database" class="nav-link" data-scroll-target="#connect-to-the-database"><span class="toc-section-number">1.6</span>  Connect to the database</a></li>
  <li><a href="#use-your-own-.renviron-keys-to-select-the-database-that-you-want-to-access" id="toc-use-your-own-.renviron-keys-to-select-the-database-that-you-want-to-access" class="nav-link" data-scroll-target="#use-your-own-.renviron-keys-to-select-the-database-that-you-want-to-access"><span class="toc-section-number">1.7</span>  use your own .Renviron “keys” to select the database that you want to access</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Connect to the database</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="getting-started" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="getting-started"><span class="header-section-number">1.1</span> Getting started</h2>
<p>To connect to databases we will use DBI package and CDMConnector, you can find more information about both packages in their websites:</p>
<ul>
<li><p>DBI package website: <a href="https://dbi.r-dbi.org/" class="uri">https://dbi.r-dbi.org/</a></p></li>
<li><p>CDMConnector package website: <a href="https://darwin-eu.github.io/CDMConnector/" class="uri">https://darwin-eu.github.io/CDMConnector/</a></p></li>
</ul>
<p>Connect to database (standard way) and set up the environment</p>
<p>To connect to the database, you need to know some parameters of it: server_dbi, port, host, server, user, and password.</p>
<p>server_dbi is different for each one of the databases: e.g.&nbsp;</p>
<p>server_dbi &lt;- “cdm_aurum_202106”</p>
<p>Port is the port used to connect to the database for the moment our databases use port 5432.</p>
<p>port &lt;- “5432”</p>
<p>Host is the IP of the computer that contains the databases. For the moment the host of all our current databases is: 163.1.64.2</p>
<p>host &lt;- “163.1.64.2”</p>
<p>Server is the combination of the host and the server_dbi with a slash “/” in between.</p>
<p>server &lt;- “163.1.64.2/cdm_aurum_202106”</p>
<p>User and password are provided by the database administrator (e.g.&nbsp;Antonella), and they are personal and nontransferable. One of the first things that we will have to do is to change the password, from the default one (given by the administrator) to one of our choices (see STEP 2). The username and password are shared by all the databases that we have on the same port and server, so we need to change it only once.</p>
<p>user &lt;- “…”</p>
<p>password &lt;- “…”</p>
<p>STEP 0 Install the libraries</p>
<p>The libraries necessary to connect to a database are: DBI, RPostgres, dplyr, dbplyr, usethis, DatabaseConnector and here. They are all CRAN libraries so there should not be any problem installing them: if you have any problem please ask for help. To install them run the following commands:</p>
<p>STEP 1 Connect to a database for first time</p>
<p>Execute the following commands, make sure that you fill the parameters of the database accordingly (lines 7-11).</p>
</section>
<section id="load-libraries" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="load-libraries"><span class="header-section-number">1.2</span> Load libraries</h2>
<p>The following libraries will be used in this chapter: DBI, RPostgres, dplyr, dbplyr, usethis and here. If you do not have them installed you can install them with the following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"DBI"</span>, <span class="st">"RPostgres"</span>, <span class="st">"dplyr"</span>, <span class="st">"dbplyr"</span>, <span class="st">"usethis"</span>, <span class="st">"here"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>library(“DBI”)</p>
<p>library(“RPostgres”)</p>
</section>
<section id="set-connection-details" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="set-connection-details"><span class="header-section-number">1.3</span> Set connection details</h2>
</section>
<section id="substitute-the-next-5-lines-with-the-specifications-of-the-database-that-you" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="substitute-the-next-5-lines-with-the-specifications-of-the-database-that-you"><span class="header-section-number">1.4</span> Substitute the next 5 lines with the specifications of the database that you</h2>
</section>
<section id="want-to-connect" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="want-to-connect"><span class="header-section-number">1.5</span> want to connect</h2>
<p>server_dbi &lt;- “…”</p>
<p>user &lt;- “…”</p>
<p>password &lt;- “…”</p>
<p>port &lt;- “…”</p>
<p>host &lt;- “…”</p>
</section>
<section id="connect-to-the-database" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="connect-to-the-database"><span class="header-section-number">1.6</span> Connect to the database</h2>
<p>db &lt;- dbConnect(RPostgres::Postgres(),</p>
<pre><code>                    dbname = server_dbi, 

port = port, 

   host = host, </code></pre>
<p>user = user,</p>
<pre><code>    password = password) </code></pre>
<p>To check that you are connected run the following commands:</p>
<p>library(“dplyr”)</p>
<p>tbl(db, sql(“SELECT * FROM public.person limit 1”))</p>
<p>If you are connected you should see something like this in your terminal:</p>
<p>ShapeBackground pattern</p>
<p>Description automatically generated</p>
<p>STEP 2 Change the password (only to be executed the first time a user connects)</p>
<p>For the new password make sure that you chose a strong password.</p>
<p>After connecting to the database with the temporary password, to change the password, you must execute the following command in the terminal:</p>
<p>dbGetQuery(db, “ALTER USER user WITH PASSWORD ‘new_password’”)</p>
<p>Example:</p>
<p>dbGetQuery(db, “ALTER USER martics WITH PASSWORD ‘12345678’”)</p>
<p>Disconnect from the database and reconnect with the new password to make sure that the password change was effective.</p>
<p>dbDisconnect(db)</p>
<p>password &lt;- “new_password”</p>
<p>db &lt;- dbConnect(RPostgres::Postgres(),</p>
<pre><code>                    dbname = server_dbi, 

 port = port, </code></pre>
<p>host = host,</p>
<pre><code>    user = user,

    password = password) </code></pre>
<p>tbl(db, sql(“SELECT * FROM public.person limit 1”))</p>
<p>If everything worked, you must observe the same output that you observed before.</p>
<p>STEP 3 Set .Renviron</p>
<p>Including username, password and connection details in an R script is something that we must avoid at all costs. Otherwise, when we share our code or upload it in GitHub our account can be vulnerable. So NEVER include the connection details into an R script!</p>
<p>To avoid this potential problem we are going to store the connection details of our database in .Renviron file so that we can use them easily without sharing them.</p>
<p>How .Renviron works? This is a file where we write a list of variables with their values that we can access from any R script. For example, if I add to the file:</p>
<p>NAME = “marti”</p>
<p>When I execute the following command, I will obtain “marti” as a result:</p>
<p>Sys.getenv(“NAME”)</p>
<p>So this two commands would have the same output, but in the second case without having the same .Renviron file someone external won’t be able to read it.</p>
<p>x &lt;- “marti”</p>
<p>x &lt;- Sys.getenv(“NAME”)</p>
<p>To open and set the .Renviron file we have two options:</p>
<p>OPTION 1: open directly the file:</p>
<p>Graphical user interface, application</p>
<p>Description automatically generated</p>
<p>OPTION 2: write the following command in the console:</p>
<p>usethis::edit_r_environ()</p>
<p>Once you have it opened you must add the follow to the file:</p>
<p>DB_USER = “xxx” # Username for the database</p>
<p>DB_PASSWORD = “xxx” # Password for the database, the new one!!</p>
<p>DB_PORT = “5432”</p>
<p>DB_HOST = “163.1.64.2”</p>
<p>DB_SERVER_name_database = “163.1.64.2/xxx” # xxx depends on the database that you</p>
<p>DB_SERVER_DBI_name_database = “xxx” # want to access, see section 4.</p>
<p>Instead of DB_SERVER_DBI_name_database we can write a name that we can remember easily. For example, for CPRD AURUM May 2021 release I would write in .Renviron file:</p>
<p>DB_SERVER_DBI_aurum202106 = “cdm_aurum_202106”</p>
<p>And call it from the main script as:</p>
<p>server_dbi &lt;- Sys.getenv(“DB_SERVER_DBI_aurum202106”)</p>
<p>But as said we can use any name that we want to use.</p>
<p>Important!! Every time that we change .Renviron file, R must be rebooted (Session / Restart R, or Ctrl+Shift+F10) so that the changes are effective.</p>
<p>STEP 4 Check that .Renviron setting works</p>
<p>After rebooting, execute the following code to check if you can connect to the data base:</p>
<p>library(“DBI”)</p>
<p>library(“RPostgres”)</p>
</section>
<section id="use-your-own-.renviron-keys-to-select-the-database-that-you-want-to-access" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="use-your-own-.renviron-keys-to-select-the-database-that-you-want-to-access"><span class="header-section-number">1.7</span> use your own .Renviron “keys” to select the database that you want to access</h2>
<p>server_dbi &lt;- Sys.getenv(“DB_SERVER_DBI_name_database”)</p>
<p>user &lt;- Sys.getenv(“DB_USER”)</p>
<p>password &lt;- Sys.getenv(“DB_PASSWORD”)</p>
<p>port &lt;- Sys.getenv(“DB_PORT”)</p>
<p>host &lt;- Sys.getenv(“DB_HOST”)</p>
<p>db &lt;- dbConnect(RPostgres::Postgres(),</p>
<pre><code>                    dbname = server_dbi, 

    port = port, 

    host = host,

     user = user,

    password = password) </code></pre>
<p>tbl(db, sql(“SELECT * FROM public.person limit 1”))</p>
<p>If you connected correctly to the database, you must observe the same output that you observed before.</p>
<p>Connect to the database (OHDSI way)</p>
<p>The connector used in OHDSI packages is different from the one used in the “standard way”. To create the connection used in OHDSI packages for your database you must use the following commands:</p>
<p>library(“DatabaseConnector”)</p>
<p>library(“here”)</p>
<p>server &lt;- Sys.getenv(“DB_SERVER_name_database”)</p>
<p>user &lt;- Sys.getenv(“DB_USER”)</p>
<p>password &lt;- Sys.getenv(“DB_PASSWORD”)</p>
<p>port&lt;- Sys.getenv(“DB_PORT”)</p>
<p>host &lt;- Sys.getenv(“DB_HOST”)</p>
<p>connectionDetails &lt;- DatabaseConnector::downloadJdbcDrivers(“postgresql”,</p>
<pre><code>                                                        here::here()) </code></pre>
<p>connectionDetails &lt;- DatabaseConnector::createConnectionDetails(</p>
<pre><code>                            dbms = "postgresql", </code></pre>
<p>server = server,</p>
<p>user = user,</p>
<p>password = password,</p>
<p>port = port,</p>
<p>pathToDriver = here::here())</p>
<p>Important considerations</p>
<p>The SQL dialect of our database is: postgresql. This will be needed in some functions (manly OHDSI packages) as an input.</p>
<p>targetDialect &lt;- “postgresql”</p>
<p>IMPORTANT!!</p>
<p>The database works with schemas each schema contains different tables and data. The two schemas that we have access to are:</p>
<p>Public: contains the mapped data and the vocabularies. This schema should NEVER be used to write.</p>
<p>This should be automatically achieved if people have the correct privileges and do not use WebAPI privileges.</p>
<p>Results: should be the only schema where the users have read and write privileges. It contains the cohorts that we create as well as the tables that we upload.</p>
<p>cdm_database_schema &lt;- “public” vocabulary_database_schema &lt;- “public” results_database_schema&lt;- “results”</p>
<p>Available databases</p>
<p>For the moment we have access to 4 databases:</p>
<p>cdm_aurum_202106 - CPRD AURUM 2021_06 release</p>
<p>p20_059_cdm_aurum - CPRD AURUM for protocol 20_059.</p>
<p>p20_000211_cdm_aurum - CPRD AURUM for protocol 20_000211.</p>
<p>cdmgold202007 - CPRD GOLD 2020_07 release.</p>
<p>A suggestion of data to add to the .Renviron file would be:</p>
<p>DB_SERVER_aurum_202106 = “163.1.64.2/cdm_aurum_202106”</p>
<p>DB_SERVER_DBI_aurum_202106 = “cdm_aurum_202106”</p>
<p>DB_SERVER_aurum_protocol_059 = “163.1.64.2/p20_059_cdm_aurum”</p>
<p>DB_SERVER_DBI_ aurum_protocol_059 = “p20_059_cdm_aurum”</p>
<p>DB_SERVER_aurum_protocol_211 = “163.1.64.2/p20_000211_cdm_aurum”</p>
<p>DB_SERVER_DBI_aurum_protocol_211 = “p20_000211_cdm_aurum”</p>
<p>DB_SERVER_gold_202007 = “163.1.64.2/cdmgold202007”</p>
<p>DB_SERVER_DBI_gold_202007 = “cdmgold202007”</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>